name: CI

on:
    pull_request:
        branches: [ "main" ]
    push:
        branches: [ "main" ]

jobs:
    backend_build:
        name: backend-build
        runs-on:  ubuntu-latest
        defaults:
            run:
                working-directory: backend/src
        steps:
            - name: Checkout
              uses: actions/checkout@v4
            - name: Setup .NET
              uses: actions/setup-dotnet@v4
              with: 
                dotnet-version: "8.0.x"
            - name: Restore
              run: dotnet restore API/API.csproj
            - name: Build
              run: dotnet build API/API.csproj --no-restore -c Release
            
    frontend_build:
        name: frontend-build
        runs-on: ubuntu-latest
        defaults:
            run:
                working-directory: frontend/src/website-frontend
        steps:
            - name: Checkout
              uses: actions/checkout@v4
            - name: Setup Node
              uses: actions/setup-node@v4
              with: 
                node-version: "20"
                cache: "npm"
                cache-dependency-path: "frontend/src/website-frontend/package-lock.json"
            - name: Install 
              run: npm ci
            - name: Build
              run: npm run build

 